# 1부 2장 : URL-2

[1부 2장 : URL-1:URL과 리소스](https://www.notion.so/1-2-URL-1-URL-e59bd0c349d54104993efb3d3200ef77)

# 단축 URL

---
<br/>
## 1. 상대URL

URL은 상대 URL과 절대 URL 두 가지로 나뉜다.

- 상대 URL은 리소스 안에 있는 리소스를 간결하게 기술할 때 사용할 수 있다. - 짧게 표기한다.
- 절대 URL은 리소스에 접근하는 데 필요한 모든 정보를 가지고 있다.(여태껏 예시로 봐온)
- 상대 URL은 모든 정보를 담고 있지 않고, 기저(base) URL을 사용해야 한다.

[**http://growto.kr/tools.html](http://growto.kr/tools.html)의 문서**

```
<HTML>
<a href="./hammers.html"></a>
</HTML>
```

"./hammers.html" : 미완성인 것처럼 보이지만, 올바른 문법의 상대 url이다.

HTML 작성자는 URL에 스킴, 호스트와 다른 컴포넌트들을 모두 입력하지 않아도 되며, 이러한 정보들은 리소스의 기저 URL에서 알아낼 수 있다.

위의 예시의 경우 기저 URL은 [`http://growto.kr/tools.html`](http://growto.kr/tools.html)이다. 

상대 URL은 프래그먼트거나 URL 일부다. URL을 처리하는 브라우저, 애플리케이션들은 상대 URL과 절대 URL 간에 상호 변환을 할 수 있어야 한다.

### 상대 참조 해석 과정

- 경로가 ./hammers.html고 , 기저 url 이 http://www.growto.kr/tools.html이라면
- 상대참조의 스킴 컴포넌트가 비어있기 때문에 기저 url의 스킴인 http를 상속받는다.
- 호스트와 포트 컴포넌트도 비어있기 때문에 상속받는다.
- 상대 url과 상속받은 컴포넌트를 합치면 새 절대 url인 [http://www.growto.kr/hammers.html을](http://www.growto.kr/hammers.html을) 얻을 수 있다.

<br/>
## 2. URL 확장

사용자가 url을 빠르게 입력하게 도와주고, 자동으로 url을 확장시켜 전체를 입력하지 않도록 해준다.

### 1) 호스트명 확장

- 호스트명 확장 기능을 제공하는 브라우저에 ‘growto’만 입력해도, 브라우저는 호스트명에 자동으로 ‘www.’, ‘.kr’을 붙여서 ‘www.growto.kr’을 만든다.
- 어떤 브라우저는 ‘growto’란 단어를 포함한 사이트를 못 찾으면 몇 가지 url을 추가로 제시한다.
- 하지만 호스트명 확장 기능은 프락시와 같은 다른 http애플리케이션에 문제를 발생시키기도 한다. → 6장에서 자세히

### 2) 히스토리 확장

- 과거 사용자가 방문한 URL 기록을 저장한다.
- 사용자가 URL 입력 시 앞 글자들을 포함하는 완성된 URL을 선택할 수 있게 한다.
- 프락시 사용 시 자동 확장 기능은 다르게 동작할 수 있다 → 6장에서 자세히.


# 안전하지 않은 문자

---

모든 프로토콜이 데이터를 전송하기 위해 서로 다른 장치를 가지고 있다. 어떤 인터넷 프로토콜을 통해서 전송을 하든, 안전하게 전송이 될 수 있도록 URL을 설계하는 것은 중요한 일이었다.

SMTP(Simple Mail Transfer Protocol) 프로토콜은 특정 문자를 제거할 수도 있는 전송 방식을 사용한다. 문자가 제거되는 일을 피하고자 url은 상대적으로 작고 **안전한 알파벳 문자만을 포함하도록** 허락한다.


<br/>
## 1. URL 문자 집합

많은 컴퓨터 애플리케이션은 **US-ASCII**문자 집합을 사용해왔다. 

US-ASCII는 7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현한다. 적은 수의 문자만을 포함하고, 유럽언어 / 라틴계 언어에 있는 변형된 문자는 지원하지 않는다.

URL이 특정 이진 데이터를 포함해야한는 경우도 있는데, 이런 문자의 한계점을 지원하기 위해 URL에 이스케이프 문자열을 쓸 수 있게 설계했다.
<br/>
## 2. 이스케이프 인코딩 체계

안전하지 않는 문자들을 url에서 표현할 수 있도록 하는 인코딩 방식이 고안되었다.

안전하지 않는 문자들을 인코딩하여 앞이 %기호로 시작하며, 이어서 ASCII 16진수 숫자로 이뤄진 이스케이프 문자로 바꾸어준다.

| 예시문자 | ASCII코드 | 인코딩 |
| --- | --- | --- |
| ~ | 126 | %7E (7E는 126의 16진수 표현) |
|  빈 문자 | 32 | %20 |
| % | 37 | %25 |

<br/>
## 3. 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 쓰이는, **이미 예약된 문자**이다. 

어떤 문자는 US-ASCII의 출력 가능한 문자 집합에 포함되어 있지 않다.

어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동되는 것으로 알려져 사용이 꺼려진다.

이처럼 제한된 문자들이 있고, 본래의 목적이 아닌 용도로 사용될 때, 사용 전 반드시 인코딩 되어야 하는 문자들이 있다.

| 문자 | 선점 및 제한 |
| --- | --- |
| % | 선점: 인코딩된 문자에 사용되는 이스케이프 토큰  |
| / | 선점 : 경로 컴포넌트의 세그먼트를 나누는 용도. |
| . | 선점: 경로 컴포넌트 |
| .. | 선점: 경로 컴포넌트 |
| # | 선점 : 플래그먼트의 구획 문자 |
| ? | 선점 : 질의 문자열의 구획 문자 |
| ; | 선점 : 파라미터의 구획(구분) 문자 |
| : | 선점 : 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점. |
| $, + | 선점 |
| @ & = | 선점 : 특정 스킴에서 특별한 의미가 있음 |
| {} | \ / ~ [] ` · | 제한 : 게이트웨이 같은 전송 에이전트에서 물완전하게 다룸 |
| <> “ | 웹 문서에서 URL 구분지어 표시할 때 URL범위 밖에서 역할이 있는 문자이므로 반드시 인코딩해야함. |
<br/>

# 4. 스킴 별 포맷

| scheme | 설명 | 예시 |
| --- | --- | --- |
| http | 사용자 이름, 비밀번호가 없다는 것을 제외하면 일반 URL포맷을 지키는 하이퍼텍스트 전송 프로토콜.(HyperText Transfer Protocol)스킴. 포트값이 생략되어있으면 기본값 80이다. | http :// <호스트> : <포트> / <경로> ? <질의> # 프래그먼트 |
| https | http 스킴과 거의 같으며, 차이점은 http커넥션의 양 끝단에서 암호화하기 위해 넥스케이프에서 개발한 SSL(Secure Sockets Layer, 보안 소켓 계층)을 사용한다는 점. 기본 포트값은 443. | https :// <호스트>: <포트> / <경로> ? <질의> # 프래그먼트 ex) https://www.diggging.com/secure.html |
| mailto | 이메일주소를 가리킨다. 다르스킴들과는 다르게 동작하기 때문에, 표준URL과 다른 포맷을 가진다.  인터넷 이메일 주소의 문법은 RFC 822에 기술되어있음 | mailto : <RFC-822-addr-spec> ex) mailto:jso_osj@naver.com |
| ftp | 파일 전송 프로토콜(File Transfer Protocol) URL은 FTP서버에 있는 파일을 내려 받거나 올리고, FTP 서버의 디렉토리에 있는 콘텐츠 목록을 가져올 때 사용할 수 있다. FTP는 웹과 URL이 출현하기 전부터 있었다.  웹 애플리케이션은 데이터에 접근하는 용도의 스킴으로 FTP를 사용한다. | ftp : // <사용자이름> : <비밀번호> @ <호스트> : <포트> / <경로> : <파라미터> |
| rtsp, rtspu | 실시간 스트리밍 프로토콜(Real Time Streaming Protocol)을 통해서 읽을 수 있는 오디오 및 비디오와 같은 미디어 리소스 식별자. rtspu의 ‘u’는 리소스를 읽기 위해 UDP프로토콜이 사용됨을 의미. | rtsp :// <사용자이름> : <비밀번호> @ <호스트> : <포트> / <경로> 혹은 rtspu |
| file | 주어진 호스트 기기에서 바로 접근가능한 파일들을 나타냄. 각 필드도 일반적인 url 포맷을 따르다.만약 호스트가 생략되어있으면, url을 사용중인 기기의 로컬호스트가 기본값이 된다.  |  |
| news | 특정 문서나 뉴스 그룹에 접근할 때 사용함. 리소스의 위치 정보를 충분히 포함하지 않는 특이한 속성이 있음. 호스트 명이나 서버 이름도 제공하지 않음. 해당 정보를 알아내는 것은 애플리케이션의 몫. 뉴스 리소스는 여러 서버를 통해 접근할 수 있다. ’@’문자는 뉴스 그룹을 가리키는 뉴스 url과 특정 뉴스 문서를 가리키는 뉴스 url을 구분하기 위해 사용. | news: newsgroup, news: news-article-id |
| telnet | 대화형 서비스에 접근할 때 사용 대화형 애플리케이션은 이 telnet 프로토콜을 통해 접근가능  | telnet :// <사용자이름> : <비밀번호> @ <호스트> : <포트> / |

<br/>

## 미래의 URI

URL은 세상에 존재하는 모든 객체에 이름을 지을 수 있고, 새로운 포맷을 쉽게 추가할 수 있도록 설계된 강력한 도구이다. 인터넷 프로토콜 간 공유할 수 있는 일관된 작명 규칙을 제공한다.

<br/>

### 하지만 URL은 완벽하지 않다.

URL은 리소스의 주소를 가리키지, 이름을 가리키지 않는다.
 ⇒ 특정 시점에 해당 리소스의 위치를 알려주기 위해 필요한 포트와 서버 이름을 제공한다. 

단점은, 해당 리소스가 다른 곳으로 옮겨지면 해당 URL을 더 이상 사용할 수 없다는 것이다. 그리고 기존 URL이 가리키고 있던 객체를 찾을 방법이 없다.

- 위의 문제를 해결하기 위해선, 객체 위치와 상관없으 그 객체 자체를 가리키는 이름을 사용하는 것이다. URN(Uniform Resource Name)은 객체가 옮겨지더라도 항상 객체를 가리킬 수 있는 이름을 제공한다.
- 지속 통합 자원 지시자(Persistent uniform resource locators, PURL)을 사용하면 URL로 URN의 기능을 제공할 수 있다. PURL은 리소스의실제 URL목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고 해당 리소스를 우회적으로 제공한다.

### URN의 사용

한동안 URN방식이 활용되었고, 명세도 출시되었으나 아직 채택되지 못하고 있다.

URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이다. 이를 사용하기 위해선 많은 변화가 필요할 것이다. 표준 제정과 여러 HTTP애플리케이션을 수정하기 위한 합의도 필요하다. 

URL은 나름의 한계를 갖고 있고, 고질적 문제가 있지만 그것을 해결할 수 있는 새로운 표준이 나타나고 적용될 때까지는 계속 쓰일 것이다.
